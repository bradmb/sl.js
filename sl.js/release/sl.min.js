var SLjs;(function(n){var t;(function(n){"use strict";n.ApiHost="https://slack.com/api/";n.PostMessage="chat.postMessage";n.WebSocketStart="rtm.start"})(t=n.Endpoints||(n.Endpoints={}))})(SLjs||(SLjs={})),function(n){var t;(function(t){"use strict";function i(t){var i=JSON.parse(t),f,r,u;console.log(i);switch(i.type){case"presence_change":f=i;n.Users[f.user].presence=f.presence;break;case"message":r=i;u=n.Users[r.user];n.Interface.AddChatMessage({icon_emoji:u.image,text:r.text,username:u.name});console.log(u.name+" said: "+r.text)}}t.OnMessageReceived=i})(t=n.Events||(n.Events={}))}(SLjs||(SLjs={})),function(n){var t;(function(t){"use strict";function i(t,i,r){var u=new XMLHttpRequest,o=[],f,e;for(f in t)t.hasOwnProperty(f)&&(f==="attachments"&&(t[f]=JSON.stringify(t[f])),o.push(encodeURIComponent(f)+"="+encodeURIComponent(t[f])));e=n.Endpoints.ApiHost+i+"?token="+n.Config.token+"&channel="+n.Config.channel+"&";e+=o.join("&");u.onreadystatechange=function(){r!=null&&r!==undefined&&u.readyState===4&&u.status===200&&r(u.responseText)};u.open("POST",e,!0);u.setRequestHeader("Content-Type","text/plain;charset=UTF-8");u.send()}t.Action=i})(t=n.Http||(n.Http={}))}(SLjs||(SLjs={})),function(n){var t;(function(t){"use strict";function o(t){var o=document.createElement("div"),u,f;o.id=n.Parameters.INTERFACE_WRAPPER_DIV_ID;e=t;e.appendChild(o);i=document.createElement("div");i.id=n.Parameters.INTERFACE_DIV_ID;o.appendChild(i);u=document.createElement("div");u.className="sljs-close-button";i.appendChild(u);f=document.createElement("button");f.innerText="x";f.onclick=function(){e.innerHTML=""};u.appendChild(f);r=document.createElement("div");i.appendChild(r)}function s(t){var s,f,e,u,o;i.className="sljs-welcome";s=document.createElement("h2");s.innerText=n.Strings.WELCOME_MSG;r.appendChild(s);f=document.createElement("h3");f.innerText=n.Strings.NAME_REQUIRED;r.appendChild(f);e=document.createElement("div");e.className="sljs-welcome-input";r.appendChild(e);u=document.createElement("input");u.placeholder=n.Strings.NAME_INPUT_PLACEHOLDER;e.appendChild(u);u.focus();o=document.createElement("button");o.innerText=n.Strings.NAME_INPUT_BUTTON;o.type="button";o.onclick=function(){if(u.value.trim()===""){f.className="sljs-validation-failed";f.innerText=n.Strings.NAME_INPUT_VALIDATION_ERROR;u.className="validation-failed";u.focus();return}t(u.value)};e.appendChild(o)}function h(){i.className="sljs-chat";r.innerHTML="";u=document.createElement("div");u.className="sljs-chat-messages";r.appendChild(u)}function c(n){f.push(n);f.length>10&&f.shift();l()}function l(){var n,i,t;for(u.innerHTML="",n=0;n<f.length;n++)i=f[n],t=document.createElement("div"),t.innerHTML=i.text,u.appendChild(t)}var i,r,e,u,f=[];t.ConstructInterface=o;t.ConstructWelcomeWithName=s;t.ConstructConversationWindow=h;t.AddChatMessage=c})(t=n.Interface||(n.Interface={}))}(SLjs||(SLjs={})),function(n){var t;(function(){"use strict"})(t=n.Models||(n.Models={}))}(SLjs||(SLjs={})),function(n){var t;(function(n){"use strict";n.INTERFACE_DIV_ID="sljs-interface";n.INTERFACE_WRAPPER_DIV_ID="sljs-wrapper"})(t=n.Parameters||(n.Parameters={}))}(SLjs||(SLjs={})),function(n){"use strict";var t=function(){function t(){}return t.prototype.GetWebSocketData=function(t){var i={mpim_aware:!1,no_unreads:!0,simple_latest:!0,token:n.Config.token};n.Http.Action(i,n.Endpoints.WebSocketStart,function(i){for(var r,f=JSON.parse(i),u=0,e=f.users;u<e.length;u++)r=e[u],n.Users[r.id]={name:r.real_name!==""?r.real_name:r.name,presence:r.presence,image:r.profile.image_24};t(f.url)})},t.prototype.ConnectWebSocket=function(t){var i=new WebSocket(t);i.onopen=function(){};i.onmessage=function(t){n.Events.OnMessageReceived(t.data)};i.onerror=function(){};i.onclose=function(){}},t}();n.Socket=t}(SLjs||(SLjs={})),function(n){var t;(function(n){"use strict";n.INTERNAL_APP_NAME="SL.js";n.APP_NAME=n.INTERNAL_APP_NAME;n.FIRST_MESSAGE_HEADER="First message for this visit to the channel";n.MESSAGE_REPLY_HINT="Reply to me using !v1 [message]";n.ATTACHMENT_COLOR="#D00000";n.VISITOR_ICON=":red_circle:";n.WELCOME_MSG="Welcome to "+n.APP_NAME+"!";n.NAME_REQUIRED="During our conversation, what can we call you?";n.NAME_INPUT_PLACEHOLDER="Enter your name in here";n.NAME_INPUT_VALIDATION_ERROR="Sorry, can you try entering your name in again?";n.NAME_INPUT_BUTTON="Continue";n.INITIAL_MSG="Welcome to the support channel for "+n.APP_NAME+". Please ask your question in this channel and someone will get back to you shortly."})(t=n.Strings||(n.Strings={}))}(SLjs||(SLjs={})),function(n){"use strict";n.Config={applicationName:n.Strings.APP_NAME,channel:null,element:null,token:null,useServerSideFeatures:null,visitorIcon:null,visitorName:null};n.Users={};var t=function(){function t(t){if(n.Config=t,this.constructData(),n.Interface.ConstructInterface(document.getElementById(n.Config.element)),n.Config.visitorName===null||n.Config.visitorName===undefined)n.Interface.ConstructWelcomeWithName(function(t){n.Config.visitorName=t;n.Interface.ConstructConversationWindow();var i=new n.Socket;i.GetWebSocketData(function(n){i.ConnectWebSocket(n)})});else{n.Config.visitorName+=" ("+n.Config.applicationName+")";n.Interface.ConstructConversationWindow();var i=new n.Socket;i.GetWebSocketData(function(n){i.ConnectWebSocket(n)})}}return t.prototype.constructData=function(){(n.Config.useServerSideFeatures===null||n.Config.useServerSideFeatures===undefined)&&(n.Config.useServerSideFeatures=!1);(n.Config.visitorIcon===null||n.Config.visitorIcon===undefined)&&(n.Config.visitorIcon=n.Strings.VISITOR_ICON);n.Config.applicationName===null||n.Config.applicationName===undefined?n.Config.applicationName=n.Strings.APP_NAME:n.Strings.APP_NAME=n.Config.applicationName},t.prototype.sendInitialMessage=function(t){var i=[],r;n.Config.useServerSideFeatures||i.push({title:n.Strings.FIRST_MESSAGE_HEADER,text:n.Strings.MESSAGE_REPLY_HINT,color:n.Strings.ATTACHMENT_COLOR});r={attachments:i,text:t,username:n.Config.visitorName,icon_emoji:n.Config.visitorIcon};n.Http.Action(r,n.Endpoints.PostMessage)},t.prototype.sendMessage=function(t){if(!this.firstMessageSent){this.firstMessageSent=!0;this.sendInitialMessage(t);return}var i={text:t,username:n.Config.visitorName,icon_emoji:n.Config.visitorIcon};n.Http.Action(i,n.Endpoints.PostMessage)},t}();n.Application=t}(SLjs||(SLjs={}));