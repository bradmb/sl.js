var SLjs;(function(n){var t;(function(n){"use strict";n.ApiHost="https://slack.com/api/";n.PostMessage="chat.postMessage";n.WebSocketStart="rtm.start"})(t=n.Endpoints||(n.Endpoints={}))})(SLjs||(SLjs={})),function(n){var t;(function(t){"use strict";function i(t){var i=JSON.parse(t),r,u,f;console.log(i);switch(i.type){case"presence_change":r=i;n.Users[r.user].presence=r.presence;break;case"message":u=i;f=n.Users[u.user];console.log(f.name+" said: "+u.text)}}t.OnMessageReceived=i})(t=n.Events||(n.Events={}))}(SLjs||(SLjs={})),function(n){var t;(function(t){"use strict";function i(t,i,r){var u=new XMLHttpRequest,o=[],f,e;for(f in t)t.hasOwnProperty(f)&&(f==="attachments"&&(t[f]=JSON.stringify(t[f])),o.push(encodeURIComponent(f)+"="+encodeURIComponent(t[f])));e=n.Endpoints.ApiHost+i+"?token="+n.Config.token+"&channel="+n.Config.channel+"&";e+=o.join("&");u.onreadystatechange=function(){r!=null&&r!==undefined&&u.readyState===4&&u.status===200&&r(u.responseText)};u.open("POST",e,!0);u.setRequestHeader("Content-Type","text/plain;charset=UTF-8");u.send()}t.Action=i})(t=n.Http||(n.Http={}))}(SLjs||(SLjs={})),function(n){var t;(function(t){"use strict";function f(t){var o=document.createElement("div"),f,e;o.id=n.Parameters.INTERFACE_WRAPPER_DIV_ID;u=t;u.appendChild(o);i=document.createElement("div");i.id=n.Parameters.INTERFACE_DIV_ID;o.appendChild(i);f=document.createElement("div");f.className="sljs-close-button";i.appendChild(f);e=document.createElement("button");e.innerText="x";e.onclick=function(){u.innerHTML=""};f.appendChild(e);r=document.createElement("div");i.appendChild(r)}function e(t){var s,f,e,u,o;i.className="sljs-welcome";s=document.createElement("h2");s.innerText=n.Strings.WELCOME_MSG.replace(n.Strings.APP_NAME_PARAM,n.Config.applicationName);r.appendChild(s);f=document.createElement("h3");f.innerText=n.Strings.NAME_REQUIRED;r.appendChild(f);e=document.createElement("div");e.className="sljs-welcome-input";r.appendChild(e);u=document.createElement("input");u.placeholder=n.Strings.NAME_INPUT_PLACEHOLDER;e.appendChild(u);u.focus();o=document.createElement("button");o.innerText=n.Strings.NAME_INPUT_BUTTON;o.type="button";o.onclick=function(){if(u.value.trim()===""){f.className="sljs-validation-failed";f.innerText=n.Strings.NAME_INPUT_VALIDATION_ERROR;u.className="validation-failed";u.focus();return}t(u.value)};e.appendChild(o)}function o(){i.className="sljs-chat";r.innerHTML="";var t=document.createElement("h2");t.innerText=n.Strings.WELCOME_MSG.replace(n.Strings.APP_NAME_PARAM,n.Config.applicationName);r.appendChild(t)}var i,r,u;t.ConstructInterface=f;t.ConstructWelcomeWithName=e;t.ConstructConversationWindow=o})(t=n.Interface||(n.Interface={}))}(SLjs||(SLjs={})),function(n){var t;(function(){"use strict"})(t=n.Models||(n.Models={}))}(SLjs||(SLjs={})),function(n){var t;(function(n){"use strict";n.INTERFACE_DIV_ID="sljs-interface";n.INTERFACE_WRAPPER_DIV_ID="sljs-wrapper"})(t=n.Parameters||(n.Parameters={}))}(SLjs||(SLjs={})),function(n){"use strict";var t=function(){function t(){}return t.prototype.GetWebSocketData=function(t){var i={mpim_aware:!1,no_unreads:!0,simple_latest:!0,token:n.Config.token};n.Http.Action(i,n.Endpoints.WebSocketStart,function(n){var i=JSON.parse(n);t(i)})},t.prototype.ConnectWebSocket=function(t){var i=new WebSocket(t);i.onopen=function(){};i.onmessage=function(t){n.Events.OnMessageReceived(t.data)};i.onerror=function(){};i.onclose=function(){}},t}();n.Socket=t}(SLjs||(SLjs={})),function(n){var t;(function(n){"use strict";n.APP_NAME="SL.js";n.FIRST_MESSAGE_HEADER="First message for this visit to the channel";n.MESSAGE_REPLY_HINT="Reply to me using !v1 [message]";n.ATTACHMENT_COLOR="#D00000";n.VISITOR_ICON=":red_circle:";n.APP_NAME_PARAM="%APPNAME%";n.WELCOME_MSG="Welcome to "+n.APP_NAME_PARAM+"!";n.NAME_REQUIRED="During our conversation, what can we call you?";n.NAME_INPUT_PLACEHOLDER="Enter your name in here";n.NAME_INPUT_VALIDATION_ERROR="Sorry, can you try entering your name in again?";n.NAME_INPUT_BUTTON="Continue"})(t=n.Strings||(n.Strings={}))}(SLjs||(SLjs={})),function(n){"use strict";n.Users={};var t=function(){function t(t){if(n.Config=t,this.constructData(),n.Interface.ConstructInterface(document.getElementById(n.Config.element)),n.Config.visitorName===null||n.Config.visitorName===undefined)n.Interface.ConstructWelcomeWithName(function(t){n.Config.visitorName=t;n.Interface.ConstructConversationWindow()});else{n.Config.visitorName+=" ("+n.Config.applicationName+")";n.Interface.ConstructConversationWindow();var i=new n.Socket;i.GetWebSocketData(function(t){var u,r;for(u in t.users)t.users.hasOwnProperty(u)&&(r=t.users[u],n.Users[r.id]={name:r.real_name!==""?r.real_name:r.name,presence:r.presence,image:r.profile.image_24});i.ConnectWebSocket(t.url)})}}return t.prototype.constructData=function(){(n.Config.useServerSideFeatures===null||n.Config.useServerSideFeatures===undefined)&&(n.Config.useServerSideFeatures=!1);(n.Config.visitorIcon===null||n.Config.visitorIcon===undefined)&&(n.Config.visitorIcon=n.Strings.VISITOR_ICON);(n.Config.applicationName===null||n.Config.applicationName===undefined)&&(n.Config.applicationName=n.Strings.APP_NAME)},t.prototype.sendInitialMessage=function(t){var i=[],r;n.Config.useServerSideFeatures||i.push({title:n.Strings.FIRST_MESSAGE_HEADER,text:n.Strings.MESSAGE_REPLY_HINT,color:n.Strings.ATTACHMENT_COLOR});r={attachments:i,text:t,username:n.Config.visitorName,icon_emoji:n.Config.visitorIcon};n.Http.Action(r,n.Endpoints.PostMessage)},t.prototype.sendMessage=function(t){if(!this.firstMessageSent){this.firstMessageSent=!0;this.sendInitialMessage(t);return}var i={text:t,username:n.Config.visitorName,icon_emoji:n.Config.visitorIcon};n.Http.Action(i,n.Endpoints.PostMessage)},t}();n.Application=t}(SLjs||(SLjs={}));