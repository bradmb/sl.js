var SLjs;(function(n){var t;(function(n){"use strict";n.ApiHost="https://slack.com/api/";n.PostMessage="chat.postMessage";n.WebSocketStart="rtm.start"})(t=n.Endpoints||(n.Endpoints={}))})(SLjs||(SLjs={})),function(n){var t;(function(t){"use strict";function i(t){var r=JSON.parse(t),u,i,f;switch(r.type){case"presence_change":u=r;n.Users[u.user].presence=u.presence;break;case"message":i=r;i.username!==undefined&&i.username==n.Config.visitorName?n.Interface.AddChatMessage({icon_emoji:i.icons.image_64,text:i.text,username:"You"}):(f=n.Users[i.user],n.Interface.AddChatMessage({icon_emoji:f.image,text:i.text,username:f.name}))}}t.OnMessageReceived=i})(t=n.Events||(n.Events={}))}(SLjs||(SLjs={})),function(n){var t;(function(t){"use strict";function i(t,i,r){var u=new XMLHttpRequest,o=[],f,e;for(f in t)t.hasOwnProperty(f)&&(f==="attachments"&&(t[f]=JSON.stringify(t[f])),o.push(encodeURIComponent(f)+"="+encodeURIComponent(t[f])));e=n.Endpoints.ApiHost+i+"?token="+n.Config.token+"&channel="+n.Config.channel+"&";e+=o.join("&");u.onreadystatechange=function(){r!=null&&r!==undefined&&u.readyState===4&&u.status===200&&r(u.responseText)};u.open("POST",e,!0);u.setRequestHeader("Content-Type","text/plain;charset=UTF-8");u.send()}t.Action=i})(t=n.Http||(n.Http={}))}(SLjs||(SLjs={})),function(n){var t;(function(t){"use strict";function s(t){var o=document.createElement("div"),u,f;o.id=n.Parameters.INTERFACE_WRAPPER_DIV_ID;e=t;e.appendChild(o);r=document.createElement("div");r.id=n.Parameters.INTERFACE_DIV_ID;o.appendChild(r);u=document.createElement("div");u.className="sljs-close-button";r.appendChild(u);f=document.createElement("button");f.innerText="x";f.onclick=function(){e.innerHTML=""};u.appendChild(f);i=document.createElement("div");r.appendChild(i)}function h(t){var s,f,e,u,o;r.className="sljs-welcome";s=document.createElement("h2");s.innerText=n.Strings.WELCOME_MSG;i.appendChild(s);f=document.createElement("h3");f.innerText=n.Strings.NAME_REQUIRED;i.appendChild(f);e=document.createElement("div");e.className="sljs-welcome-input";i.appendChild(e);u=document.createElement("input");u.placeholder=n.Strings.NAME_INPUT_PLACEHOLDER;e.appendChild(u);u.focus();o=document.createElement("button");o.innerText=n.Strings.NAME_INPUT_BUTTON;o.type="button";o.onclick=function(){if(u.value.trim()===""){f.className="sljs-validation-failed";f.innerText=n.Strings.NAME_INPUT_VALIDATION_ERROR;u.className="validation-failed";u.focus();return}t(u.value)};e.appendChild(o)}function c(){r.className="sljs-chat";i.innerHTML="";u=document.createElement("div");u.className="sljs-chat-messages";i.appendChild(u);var t=document.createElement("textarea");t.className="sljs-chat-message-input";t.placeholder=n.Strings.CHAT_INPUT_PLACEHOLDER;t.onkeypress=function(i){return i.charCode==13&&i.shiftKey?!0:i.charCode==13?(n.Messaging.SendMessage(t.value),t.value="",!1):!0};i.appendChild(t);o({text:n.Strings.CHAT_INITIAL_MSG,username:n.Strings.APP_NAME,icon_emoji:null})}function o(t){for(var i=n.Parameters.REGEX_URL_MATCH_QUERY.exec(t.text),r;i!=null;){if(i==null)return;r=document.createElement("a");r.href=i[1];r.text=i[1];r.target="_blank";t.text=t.text.replace(i[0],r.outerHTML);i=n.Parameters.REGEX_URL_MATCH_QUERY.exec(t.text)}t.username.length>1&&(t.username=t.username.charAt(0).toUpperCase()+t.username.slice(1),t.username.indexOf(" ")!=-1&&(t.username=t.username.split(" ")[0]));t.text=t.text.replace("\n",document.createElement("br").outerHTML);f.push(t);f.length>10&&f.shift();l()}function l(){var r,t,i,e,o,s;for(u.innerHTML="",r=0;r<f.length;r++)t=f[r],i=document.createElement("div"),i.className="sljs-chat-item",u.appendChild(i),t.icon_emoji!=null&&(e=document.createElement("img"),e.className="sljs-chat-item-icon",e.src=t.icon_emoji,i.appendChild(e)),t.username!=n.Strings.APP_NAME&&(o=document.createElement("div"),o.className="sljs-chat-item-sender",o.innerText=t.username!="You"?t.username+" @ "+n.Config.supportGroupName:t.username,i.appendChild(o)),s=document.createElement("div"),s.className="sljs-chat-item-body",s.innerHTML=t.text,i.appendChild(s)}var r,i,e,u,f=[];t.ConstructInterface=s;t.ConstructWelcomeWithName=h;t.ConstructConversationWindow=c;t.AddChatMessage=o})(t=n.Interface||(n.Interface={}))}(SLjs||(SLjs={})),function(n){var t;(function(t){"use strict";function i(t){if(!this.firstMessageSent){this.firstMessageSent=!0;r(t);return}var i={text:t,username:n.Config.visitorName,icon_emoji:n.Config.visitorIcon};n.Http.Action(i,n.Endpoints.PostMessage)}function r(t){var i=[],r;n.Config.useServerSideFeatures||i.push({title:n.Strings.FIRST_MESSAGE_HEADER,text:n.Strings.MESSAGE_REPLY_HINT,color:n.Strings.ATTACHMENT_COLOR});r={attachments:i,text:t,username:n.Config.visitorName,icon_emoji:n.Config.visitorIcon};n.Http.Action(r,n.Endpoints.PostMessage)}t.SendMessage=i})(t=n.Messaging||(n.Messaging={}))}(SLjs||(SLjs={})),function(n){var t;(function(){"use strict"})(t=n.Models||(n.Models={}))}(SLjs||(SLjs={})),function(n){var t;(function(n){"use strict";n.REGEX_URL_MATCH_QUERY=/<([^><a]+)>/g;n.INTERFACE_DIV_ID="sljs-interface";n.INTERFACE_WRAPPER_DIV_ID="sljs-wrapper"})(t=n.Parameters||(n.Parameters={}))}(SLjs||(SLjs={})),function(n){"use strict";var t=function(){function t(){}return t.prototype.GetWebSocketData=function(t){var i={mpim_aware:!1,no_unreads:!0,simple_latest:!0,token:n.Config.token};n.Http.Action(i,n.Endpoints.WebSocketStart,function(i){for(var r,f=JSON.parse(i),u=0,e=f.users;u<e.length;u++)r=e[u],n.Users[r.id]={name:r.real_name!==""?r.real_name:r.name,presence:r.presence,image:r.profile.image_72};t(f.url)})},t.prototype.ConnectWebSocket=function(t){var i=new WebSocket(t);i.onopen=function(){};i.onmessage=function(t){n.Events.OnMessageReceived(t.data)};i.onerror=function(){};i.onclose=function(){}},t}();n.Socket=t}(SLjs||(SLjs={})),function(n){var t;(function(n){"use strict";n.INTERNAL_APP_NAME="SL.js";n.INTERNAL_SUPPORT_GROUP_NAME="Support Team";n.APP_NAME=n.INTERNAL_APP_NAME;n.FIRST_MESSAGE_HEADER="First message for this visit to the channel";n.MESSAGE_REPLY_HINT="Reply to me using !v1 [message]";n.ATTACHMENT_COLOR="#D00000";n.VISITOR_ICON=":red_circle:";n.WELCOME_MSG="Welcome to "+n.APP_NAME+"!";n.NAME_REQUIRED="During our conversation, what can we call you?";n.NAME_INPUT_PLACEHOLDER="Enter your name in here";n.NAME_INPUT_VALIDATION_ERROR="Sorry, can you try entering your name in again?";n.NAME_INPUT_BUTTON="Continue";n.CHAT_INPUT_PLACEHOLDER="Enter your message here. Use SHIFT+ENTER to create a new line.";n.CHAT_INITIAL_MSG="Welcome to the support channel for "+n.APP_NAME+". Please ask your question in this channel and someone will get back to you shortly."})(t=n.Strings||(n.Strings={}))}(SLjs||(SLjs={})),function(n){"use strict";n.Config={applicationName:n.Strings.APP_NAME,channel:null,element:null,token:null};n.Users={};var t=function(){function t(t){if(n.Config=t,this.constructData(),n.Interface.ConstructInterface(document.getElementById(n.Config.element)),n.Config.visitorName===null||n.Config.visitorName===undefined)n.Interface.ConstructWelcomeWithName(function(t){n.Config.visitorName=t;n.Interface.ConstructConversationWindow();var i=new n.Socket;i.GetWebSocketData(function(n){i.ConnectWebSocket(n)})});else{n.Config.visitorName+=" ("+n.Config.applicationName+")";n.Interface.ConstructConversationWindow();var i=new n.Socket;i.GetWebSocketData(function(n){i.ConnectWebSocket(n)})}}return t.prototype.constructData=function(){(n.Config.useServerSideFeatures===null||n.Config.useServerSideFeatures===undefined)&&(n.Config.useServerSideFeatures=!1);(n.Config.visitorIcon===null||n.Config.visitorIcon===undefined)&&(n.Config.visitorIcon=n.Strings.VISITOR_ICON);n.Config.applicationName===null||n.Config.applicationName===undefined?n.Config.applicationName=n.Strings.APP_NAME:n.Strings.APP_NAME=n.Config.applicationName;(n.Config.supportGroupName===null||n.Config.supportGroupName===undefined)&&(n.Config.supportGroupName=n.Strings.INTERNAL_SUPPORT_GROUP_NAME)},t}();n.Application=t}(SLjs||(SLjs={}));